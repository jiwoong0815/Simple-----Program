# 거래명세서 생성 툴

이 프로그램은 GUI를 통해 거래명세서를 Excel 파일(.xlsx)로 쉽게 생성할 수 있도록 돕는 도구입니다.
거래처(회사) 정보와 품목 정보를 관리하고, 이를 바탕으로 명세서를 작성할 수 있습니다.

## 주요 기능

- **거래처 관리**: 회사 정보를 추가, 수정, 삭제할 수 있습니다.
- **품목 관리**: 품목(단가 포함) 정보를 추가, 수정, 삭제할 수 있습니다.
- **거래명세서 작성**:
    - 등록된 거래처와 품목을 선택하고 수량을 입력하여 명세서에 추가합니다.
    - 실시간으로 총 합계를 확인할 수 있습니다.
    - 작성된 명세서를 Excel 파일로 생성합니다.
- **데이터 영속성**: 모든 거래처 및 품목 정보는 `data.json` 파일에 저장되어 프로그램 종료 후에도 유지됩니다.
- **Excel 출력**: `openpyxl` 라이브러리를 사용하여 지정된 형식의 Excel 파일을 생성합니다.
- **초기 데이터**: 프로그램 첫 실행 시 `data.json` 파일이 없으면, 테스트용 샘플 데이터가 포함된 파일이 자동 생성됩니다.

## 사용 방법

1.  **프로그램 실행**:
    *   Python 3.11 환경이 필요합니다.
    *   `openpyxl` 라이브러리가 설치되어 있어야 합니다. (`pip install openpyxl`)
    *   `main.py` 파일을 실행합니다: `python main.py`

2.  **거래처 관리 탭**:
    *   **목록**: 등록된 거래처들이 표시됩니다. 목록에서 거래처를 선택하면 오른쪽에 세부 정보가 나타납니다.
    *   **정보 입력**: `회사명`, `연락처`를 입력합니다.
    *   **새로 입력**: 입력 필드를 초기화합니다.
    *   **추가**: 새 거래처 정보를 저장합니다. 회사명은 필수이며, 중복될 수 없습니다.
    *   **수정**: 목록에서 선택된 거래처의 정보를 수정합니다.
    *   **삭제**: 목록에서 선택된 거래처를 삭제합니다.

3.  **품목 관리 탭**:
    *   **목록**: 등록된 품목들이 표시됩니다. 목록에서 품목을 선택하면 오른쪽에 세부 정보가 나타납니다.
    *   **검색**: 품목명으로 목록을 필터링할 수 있습니다.
    *   **정보 입력**: `품목명`, `단가(VAT 포함, 원)`를 입력합니다. 단가는 소수점 둘째 자리까지 가능합니다.
    *   **새로 입력**: 입력 필드를 초기화합니다.
    *   **추가**: 새 품목 정보를 저장합니다. 품목명과 단가는 필수이며, 품목명은 중복될 수 없습니다.
    *   **수정**: 목록에서 선택된 품목의 정보를 수정합니다.
    *   **삭제**: 목록에서 선택된 품목을 삭제합니다.

4.  **거래명세서 작성 탭**:
    *   **거래처 선택**: 드롭다운 메뉴에서 명세서를 발행할 거래처를 선택합니다.
    *   **담당자 (선택)**: 필요한 경우 담당자 이름을 입력합니다. Excel 출력 시 포함됩니다.
    *   **품목 검색**: 추가할 품목을 검색합니다.
    *   **품목 리스트**: 검색 결과 또는 전체 품목이 표시됩니다. 추가할 품목을 선택합니다.
    *   **수량**: 선택한 품목의 수량을 입력합니다.
    *   **품목 추가**: 선택한 품목과 수량을 아래 명세서 테이블에 추가합니다. 이미 추가된 품목일 경우 수량을 합칠지 묻습니다.
    *   **거래명세서 품목 테이블**: 추가된 품목들의 `품목명`, `수량`, `단가`, `금액`이 표시됩니다.
    *   **총 합계**: 테이블 아래에 실시간으로 계산된 총 합계가 표시됩니다.
    *   **선택 품목 삭제**: 테이블에서 선택한 품목을 명세서에서 제거합니다.
    *   **명세서 초기화**: 현재 작성 중인 명세서의 모든 품목을 지우고 담당자 필드를 초기화합니다.
    *   **엑셀 생성 및 열기**: 현재 명세서 내용을 바탕으로 Excel 파일을 생성합니다.
        *   파일명 형식: `YYYYMMDD_{회사명}_invoice.xlsx`
        *   파일은 프로그램 실행 위치에 저장됩니다.
        *   생성 후, 파일이 저장된 폴더를 파일 탐색기에서 열지 여부를 묻습니다.

5.  **데이터 저장**:
    *   거래처 및 품목 정보는 추가/수정/삭제 시 `data.json` 파일에 즉시 저장됩니다.
    *   프로그램 종료 시에도 변경사항이 저장됩니다.

## 파일 구조

```
project_root/
│  main.py              # 전체 GUI 실행 및 관리
│  models.py            # Company, Item, InvoiceLine 데이터 클래스 정의
│  storage.py           # JSON 데이터 로드/저장 로직
│  invoice.py           # Excel 생성 유틸리티
│  data.json            # (자동 생성/관리) 거래처 및 품목 데이터 저장 파일
└─ README.md            # 본 사용 설명서
```

## 주의사항
- 단가 입력 시 숫자와 소수점(.)만 사용해주세요. (예: `12345.67`)
- 회사명이나 품목명에 빈 값은 허용되지 않습니다.
- 중복된 회사명 또는 품목명은 추가할 수 없습니다.
